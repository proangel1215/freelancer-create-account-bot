import pyautogui as pag
import pyperclip
import time
import json

class UpworkBot:
    # Constructor
    def __init__(self):
        pass
    def create(self):        
        profile = None
        with open("./profile.json", "r+") as file:
            profile = json.load(file)["upwork"]
        print(profile["skills"])
        pag.FAILSAFE = False
        if pag.confirm("Are you ready? Please go to browser.") != "OK":
            exit()
        pag.hotkey("ctrl", "t")
        pag.typewrite("upwork.com\n")
        time.sleep(1)
        pag.click(1770,53)
        time.sleep(1)
        pag.click(1750,260)
        time.sleep(5)
        pag.click(1285,739)
        time.sleep(1)
        pag.click(1675,110)
        time.sleep(1)
        pag.click(1100,380)
        time.sleep(1)
        pag.click(952,514)
        pag.hotkey("ctrl", "t")
        pag.typewrite("addy.io\n")
        time.sleep(1)
        pag.click(1438,122)
        time.sleep(1)
        pag.click(52,272)
        time.sleep(1)
        pag.click(1674,195)
        time.sleep(1)
        pag.click(891,469)
        time.sleep(1)
        pag.click(833,631)
        time.sleep(1)
        pag.click(773,724)
        time.sleep(0.5)
        pag.typewrite("louis")
        time.sleep(0.5)
        pag.click(830,760)
        time.sleep(1)
        pag.click(787,797)
        time.sleep(1)
        pag.click(648,401)
        time.sleep(0.5)
        pag.hotkey("ctrl", "w")
        time.sleep(0.5)
        pag.click(718,513)
        pag.hotkey("ctrl", "v")
        pag.click(708,453)
        pag.typewrite("Louis")
        pag.click(1085,450)
        pag.typewrite("Winkler")
        pag.click(830,569)
        pag.typewrite("pwd1234!@#$")
        time.sleep(0.5)
        pag.click(661,690)
        time.sleep(0.5)
        pag.click(665,735)
        time.sleep(0.5)
        pag.click(969,808)        
        if pag.confirm("Verify email and click Next") != "OK":
            exit()
        pag.click(383,704)
        time.sleep(1)
        pag.click(1393,587)
        time.sleep(1)
        pag.click(1860,1000)
        time.sleep(1)
        pag.click(800,600)
        time.sleep(1)
        pag.click(1860,1000)        
        time.sleep(1)
        pag.click(512,541)
        time.sleep(1)
        pag.click(343,745)
        time.sleep(1)
        pag.click(1860,1000)
        time.sleep(1)
        pag.click(572,545)
        time.sleep(1)
        pag.click(412,483)
        pag.typewrite(profile["heading"])
        pag.click(1860,1000)
        time.sleep(1)
        
        #Experience - 1
        pag.click(570,600)
        time.sleep(1)
        pag.click(722,265)
        pag.typewrite("web")
        time.sleep(1)
        pag.click(674,358)
        time.sleep(0.5)
        pag.click(660,362)
        pag.typewrite(profile["experience"][0]["title"])
        pag.click(690,457)
        pag.typewrite(profile["experience"][0]["city"])
        # if isinstance(profile["experience"][0]["country"], str):
        pag.click(1075,458)
        time.sleep(0.5)
        pag.click(1080,520)
        pag.typewrite(profile["experience"][0]["country"])#end if
        time.sleep(1)
        pag.click(1039,565)
        time.sleep(0.5)
        pag.click(626,497)
        time.sleep(0.5)
        pag.click(730,584)
        time.sleep(0.5)
        pag.click(680,637)
        time.sleep(0.5)
        pag.click(878,583)
        time.sleep(0.5)
        pag.click(840,690)
        time.sleep(0.5)
        pag.click(705,714)
        pag.typewrite(profile["experience"][0]["description"])
        time.sleep(0.5)
        pag.click(1257,937)
        
        #Experience - 2
        time.sleep(0.5)
        pag.click(337,605)
        time.sleep(1)
        pag.click(737,270)
        time.sleep(0.5)
        pag.click(715,357)
        time.sleep(0.5)
        pag.click(697,365)
        pag.typewrite(profile["experience"][1]["title"])
        pag.click(668,455)
        pag.typewrite(profile["experience"][1]["city"])
        time.sleep(0.5)
        pag.click(684,600)
        time.sleep(0.5)
        pag.click(684,645)
        time.sleep(0.5)
        pag.click(865,603)
        time.sleep(0.5)
        pag.click(845,809)
        time.sleep(0.5)
        pag.click(1024,604)
        time.sleep(0.5)
        pag.click(1012,646)
        time.sleep(0.5)
        pag.click(1189,597)
        time.sleep(0.5)
        pag.click(1183,711)
        time.sleep(0.5)
        pag.click(822,719)
        pag.typewrite(profile["experience"][1]["description"])
        time.sleep(0.5)
        pag.click(1264,935)
        time.sleep(1)
        pag.click(1778,1002)#Next Pgae
        time.sleep(1)
        pag.click(544,548)
        time.sleep(1)
        pag.click(772,293)
        pyperclip.copy(profile["education"]["university"])
        pag.hotkey("ctrl", "v")
        time.sleep(1.5)
        pag.click(711,352)
        time.sleep(0.5)
        pag.click(688,388)
        time.sleep(0.5)
        pag.typewrite(profile["education"]["degree"])
        pag.click(721,423)
        time.sleep(0.5)
        pag.click(716,480)
        time.sleep(0.5)
        pag.typewrite(profile["education"]["field"])
        time.sleep(1)
        pag.click(752,529)
        time.sleep(0.5)
        pag.click(735,571)
        time.sleep(0.5)
        pag.typewrite(profile["education"]["start"])
        time.sleep(0.5)
        pag.click(685,685)
        time.sleep(0.5)
        pag.click(1092,576)
        time.sleep(0.5)
        pag.typewrite(profile["education"]["end"])
        time.sleep(0.5)
        pag.click(1054,691)
        time.sleep(0.5)
        pag.click(826,716)
        pag.typewrite(profile["education"]["description"])
        time.sleep(0.5)
        pag.click(1263,905)
        time.sleep(0.5)
        pag.click(1820,999)
        time.sleep(0.5)
        pag.click(1039,541)
        time.sleep(0.5)
        pag.click(1054,712)
        time.sleep(0.5)
        pag.click(1818,1004)#Next Page
        time.sleep(1)
        pag.click(478,509)
        time.sleep(0.5)
        for i in range(0,profile["skills"].len()):
            pag.typewrite(profile["skills"][i])
            time.sleep(0.5)
            pag.press('down')
            time.sleep(0.5)
            pag.typewrite('\n')
            time.sleep(0.5)
        pag.click(1800,1003)#Next Page
        time.sleep(0.5)
        pag.click(534,543)
        pyperclip.copy(profile["description"])
        pag.hotkey("ctrl", "v")
        time.sleep(0.5)
        pag.click(1793,1001)
        time.sleep(0.5)
        pag.click(394,537)
        time.sleep(0.5)
        pag.click(1800,1000)#Next Page
        time.sleep(0.5)
        pag.click(1509,445)
        time.sleep(0.5)
        pag.click(1800,1000)#Next Page
        time.sleep(0.5)
        pag.click(682,599)
        pag.typewrite(profile["address"])
        time.sleep(0.5)
        pag.click(633,687)
        time.sleep(0.5)
        pag.typewrite(profile["city"])
        time.sleep(1)
        pag.click(637,748)
        time.sleep(0.5)
        pag.click(1310,686)
        pag.typewrite(profile["zip"])
        pag.click(781,775)
        pag.typewrite(profile["phone"])
        time.sleep(0.5)
        pag.click(424,507)
        time.sleep(0.5)
        pag.click(773,477)
        time.sleep(3.5)
        pag.click(897,170,2)#here
        time.sleep(1.5)
        pag.click(1226,830)
        time.sleep(1.5)
        pag.click(1800,1000)#Next Page
        time.sleep(1)
        pag.click(471,408)
        time.sleep(1)
        pag.click(900,550)
        time.sleep(5)
        for j in range(profile["portfolio"].len()):
            pag.click(1582,315)#blank void
            time.sleep(0.5)
            for i in range(25):
                pag.hotkey("tab")
                time.sleep(0.2)
            pag.typewrite("\n")
            time.sleep(1)
            pag.click(867,318)
            pag.typewrite(profile["portfolio"][j]["title"])
            pag.click(791,516)
            pag.typewrite(profile["portfolio"][j]["date"])
            time.sleep(0.5)
            pag.click(1296,641)
            time.sleep(2.5)
            pag.click(837,445)
            time.sleep(0.5)
            pag.click(1339,776)
            time.sleep(2)
            pag.click(827,982)
            pag.typewrite(profile["portfolio"][j]["heading"])
            pag.click(825,871)
            pag.typewrite(profile["portfolio"][j]["url"])
            pag.click(1290,697)
            time.sleep(0.5)
            pag.click(967,731)
            time.sleep(0.5)
            pag.click(865,766)
            time.sleep(0.5)
            pag.click(865,766) #repeat?
            time.sleep(0.5)
            pag.click(872,799)
            time.sleep(0.5)
            pag.click(907,331) #browse click
            time.sleep(2.5)
            pag.click(362,472)
            pag.typewrite(profile["portfolio"][j]["file"])
            time.sleep(0.5)
            pag.click(791,508)    
            if pag.confirm("Continue?") != "OK":#7~20s
                exit()
            pag.hotkey("end")
            time.sleep(0.5)
            pag.click(1333,551)
            time.sleep(2)
            pag.hotkey("end")
            time.sleep(0.5)
            pag.click(1360,548)
            time.sleep(6)
        for i in range(profile["certificate"].len()):
            pag.hotkey("end")
            time.sleep(0.5)
            pag.hotkey("pageup")
            time.sleep(0.5)
            pag.click(839,486)
            time.sleep(2)
            pag.hotkey("f5")
            time.sleep(6)
            pag.click(787,489)
            time.sleep(1)
            pag.typewrite(profile["certificate"][i])
            pag.click(788,582)
            time.sleep(0.5)
            pag.click(708,629)
            pag.typewrite(profile["certificate"][i])
            time.sleep(0.5)
            pag.click(1240,728)
            time.sleep(7)
        pag.hotkey("end")
        time.sleep(0.5)
        pag.click(979,554)
        time.sleep(2)
        pag.click(897,409)
        pag.typewrite(profile["other_exp"]["title"])
        pag.click(776,524)
        pag.typewrite(profile["other_exp"]["description"])
        time.sleep(0.5)
        pag.click(1249,823)
        time.sleep(3)
        
        
        pag.alert("Done")
        # while True:
        #     print(pag.position())
